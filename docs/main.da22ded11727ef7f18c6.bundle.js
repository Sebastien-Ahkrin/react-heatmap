(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(21)),ChartContext=react_1.createContext(null);exports.useContextDimensions=()=>{const dimensions=react_1.useContext(ChartContext);if(null===dimensions)throw new Error("useContextDimensions must be used inside a Chart");return dimensions};exports.default=({dimensions:dimensions,children:children})=>react_1.default.createElement(ChartContext.Provider,{value:dimensions},react_1.default.createElement("svg",{style:{overflow:"visible"},width:dimensions.width,height:dimensions.height},react_1.default.createElement("g",{transform:`translate(${dimensions.marginLeft}, ${dimensions.marginTop})`},children)))},233:function(module,exports,__webpack_require__){__webpack_require__(234),__webpack_require__(337),module.exports=__webpack_require__(338)},338:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(25),__webpack_require__(26),__webpack_require__(24),__webpack_require__(27),__webpack_require__(32);var _storybook_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(102),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(150);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_5__.addDecorator)(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.withKnobs);var req=__webpack_require__(508);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_5__.configure)(function loadStories(){req.keys().forEach(function(filename){return req(filename)})},module)}.call(this,__webpack_require__(339)(module))},508:function(module,exports,__webpack_require__){var map={"./index.stories.tsx":509};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=508},509:function(module,exports,__webpack_require__){"use strict";(function(module){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(21)),react_2=__webpack_require__(102),addon_knobs_1=__webpack_require__(150),ml_matrix_1=__webpack_require__(149),d3=__importStar(__webpack_require__(148)),ml_dataset_iris_1=__webpack_require__(510),index_1=__webpack_require__(512),irisNumbers=new ml_matrix_1.Matrix(ml_dataset_iris_1.getNumbers()),irisData=irisNumbers.center("column").scale("column").to2DArray(),classes=ml_dataset_iris_1.getClasses(),minValue=irisNumbers.min(),maxValue=irisNumbers.max(),convertScale=d3.scaleLinear().range([minValue,maxValue]),colorScaleNeg=d3.scaleSequential(d3.interpolateRdBu).domain([minValue,-minValue]),colorScalePos=d3.scaleSequential(d3.interpolateRdBu).domain([-maxValue,maxValue]);function customColorScale(value){const converted=convertScale(value);return converted<0?colorScaleNeg(converted):colorScalePos(converted)}react_2.storiesOf("Heatmap",module).add("Simple example",()=>react_1.default.createElement(index_1.Heatmap,{dimensions:{height:600},data:[[-20,-15,-10],[-5,0,5],[10,15,20]],xLabels:["Column 1","Column 2","Column 3"]})).add("Iris dataset with all options",()=>{const wantXLabels=addon_knobs_1.boolean("Show X labels",!0),wantYLabels=addon_knobs_1.boolean("Show Y labels",!0),yClusteringMethod=addon_knobs_1.select("Y clustering method",{"Single linkage":"single","Complete linkage":"complete","Unweighted average linkage (UPGMA)":"average","Weighted average linkage (WPGMA)":"wpgma","Centroid linkage (UPGMC)":"centroid",Ward:"ward","Ward 2":"ward2"},"complete");return react_1.default.createElement("div",{style:{height:addon_knobs_1.number("Height",1500)}},react_1.default.createElement(index_1.Heatmap,{dimensions:{marginBottom:100,marginRight:150},data:irisData,colorScale:customColorScale,yClustering:addon_knobs_1.boolean("Y clustering",!0),yClusteringWidth:addon_knobs_1.number("Y clustering width",100),yClusteringMethod:yClusteringMethod,xLabels:wantXLabels?["sepal length","sepal width","petal length","petal width"]:void 0,yLabels:wantYLabels?classes:void 0}))})}).call(this,__webpack_require__(55)(module))},512:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(21)),d3=__importStar(__webpack_require__(148)),ml_hclust_1=__webpack_require__(520),ml_matrix_1=__webpack_require__(149),utils_1=__webpack_require__(514),Chart_1=__importDefault(__webpack_require__(101)),Map_1=__importDefault(__webpack_require__(516)),XAxis_1=__importDefault(__webpack_require__(517)),YAxis_1=__importDefault(__webpack_require__(518)),YDendrogram_1=__importDefault(__webpack_require__(519));exports.Heatmap=react_1.memo(function Heatmap(props){const{xLabels:xLabels,yClustering:yClustering,yClusteringWidth:yClusteringWidth,yClusteringMethod:yClusteringMethod="complete",colorScale:colorScale=d3.interpolateYlOrRd}=props;let{data:data,yLabels:yLabels}=props;const[ref,dimensions]=utils_1.useChartDimensions(props.dimensions,yClustering?yClusteringWidth:0),domain=react_1.useMemo(()=>(function getDomain(data){let globalMin=1/0,globalMax=-1/0;for(const datum of data){const[min,max]=d3.extent(datum);if(void 0===min||void 0===max)throw new Error("cannot work without min or max");min<globalMin&&(globalMin=min),max>globalMax&&(globalMax=max)}return[globalMin,globalMax]})(data),[data]);let hierarchy=null;if(yClustering){const cluster=ml_hclust_1.agnes(data,{method:yClusteringMethod});hierarchy=d3.hierarchy(cluster);const dataCopy=new ml_matrix_1.Matrix(data);let yLabelsCopy;yLabels&&(yLabelsCopy=yLabels.slice());const order=cluster.indices();for(let i=0;i<order.length;i++)order[i]!==i&&(dataCopy.setRow(i,data[order[i]]),yLabelsCopy&&yLabels&&(yLabelsCopy[i]=yLabels[order[i]]));data=dataCopy.to2DArray(),yLabelsCopy&&(yLabels=yLabelsCopy)}const xScale=d3.scaleLinear().domain([0,data[0].length]).range([0,dimensions.boundedWidth]),yScale=d3.scaleLinear().domain([0,data.length]).range([0,dimensions.boundedHeight]),colorAccessor=d3.scaleSequential(colorScale).domain(domain),elementWidth=dimensions.boundedWidth-xScale(data[0].length-1),elementHeight=dimensions.boundedHeight-yScale(data.length-1);return react_1.default.createElement("div",{style:{height:"100%"},ref:ref},react_1.default.createElement(Chart_1.default,{dimensions:dimensions},xLabels&&react_1.default.createElement(XAxis_1.default,{labels:xLabels,xAccessor:i=>xScale(i)+elementWidth/2}),yLabels&&react_1.default.createElement(YAxis_1.default,{labels:yLabels,yAccessor:i=>yScale(i)+elementHeight/2}),react_1.default.createElement(Map_1.default,{data:data,xAccessor:xScale,yAccessor:yScale,elementWidth:elementWidth,elementHeight:elementHeight,colorAccessor:colorAccessor}),hierarchy&&react_1.default.createElement(YDendrogram_1.default,{hierarchy:hierarchy})))})},514:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(21),resize_observer_polyfill_1=__importDefault(__webpack_require__(515));function combineChartDimensions(config,additionalMarginLeft){let parsedDimensions={marginTop:40,marginRight:30,marginBottom:40,marginLeft:75,width:0,height:0,...config};return parsedDimensions.marginLeft+=additionalMarginLeft,{...parsedDimensions,boundedHeight:Math.max((parsedDimensions.height||0)-parsedDimensions.marginTop-parsedDimensions.marginBottom,0),boundedWidth:Math.max((parsedDimensions.width||0)-parsedDimensions.marginLeft-parsedDimensions.marginRight,0)}}exports.useChartDimensions=function useChartDimensions(dimensionsConfig={},yClusteringWidth=100){const ref=react_1.useRef(),dimensions=react_1.useMemo(()=>combineChartDimensions(dimensionsConfig,yClusteringWidth),[dimensionsConfig,yClusteringWidth]),[width,changeWidth]=react_1.useState(0),[height,changeHeight]=react_1.useState(0);react_1.useEffect(()=>{if(dimensions.width&&dimensions.height)return;const element=ref.current,resizeObserver=new resize_observer_polyfill_1.default(entries=>{if(!Array.isArray(entries))return;if(!entries.length)return;const entry=entries[0];width!==entry.contentRect.width&&changeWidth(entry.contentRect.width),height!==entry.contentRect.height&&changeHeight(entry.contentRect.height)});return resizeObserver.observe(element),()=>resizeObserver.unobserve(element)},[dimensions,height,width]);const newSettings=combineChartDimensions({...dimensions,width:dimensions.width||width,height:dimensions.height||height},0);return[ref,newSettings]}},516:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(21));exports.default=react_1.memo(function Map(props){const{data:data,xAccessor:xAccessor,yAccessor:yAccessor,elementHeight:elementHeight,elementWidth:elementWidth,colorAccessor:colorAccessor}=props,squares=[];for(let i=0;i<data.length;i++)for(let j=0;j<data[i].length;j++)squares.push(react_1.default.createElement("rect",{key:`${i}-${j}`,x:xAccessor(j),y:yAccessor(i),width:elementWidth,height:elementHeight,fill:colorAccessor(data[i][j])}));return react_1.default.createElement(react_1.Fragment,null,squares)})},517:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(21)),Chart_1=__webpack_require__(101);exports.default=function XAxis(props){const{labels:labels,xAccessor:xAccessor}=props,dimensions=Chart_1.useContextDimensions();return react_1.default.createElement("g",{transform:`translate(0, ${dimensions.boundedHeight})`},labels.map((label,i)=>{const x=xAccessor(i);return react_1.default.createElement(react_1.Fragment,{key:i},react_1.default.createElement("line",{x1:x,x2:x,y2:"10",stroke:"#bdc3c7"}),react_1.default.createElement("text",{transform:`translate(${x}, 15)rotate(-45)`,textAnchor:"end",fontSize:"0.8em",dominantBaseline:"hanging"},label))}))}},518:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(21)),Chart_1=__webpack_require__(101);exports.default=function YAxis(props){const{labels:labels,yAccessor:yAccessor}=props,dimensions=Chart_1.useContextDimensions();return react_1.default.createElement("g",{transform:`translate(${dimensions.boundedWidth}, 0)`},labels.map((label,i)=>{const y=yAccessor(i);return react_1.default.createElement(react_1.Fragment,{key:i},react_1.default.createElement("line",{y1:y,y2:y,x2:"10",stroke:"#bdc3c7"}),react_1.default.createElement("text",{transform:`translate(15, ${y})`,textAnchor:"start",fontSize:"0.8em",dominantBaseline:"middle"},label))}))}},519:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(21)),d3=__importStar(__webpack_require__(148)),Chart_1=__webpack_require__(101);exports.default=function YDendrogram(props){const dimensions=Chart_1.useContextDimensions(),cluster=d3.cluster().size([dimensions.boundedHeight,dimensions.marginLeft])(props.hierarchy),scaleX=d3.scaleLinear().domain([cluster.data.height,0]).range([0,dimensions.marginLeft-5]),lines=[];let key=0;return cluster.eachAfter(node=>{node.parent&&lines.push(react_1.default.createElement("line",{key:key++,x1:scaleX(node.data.height),x2:scaleX(node.parent.data.height),y1:node.x,y2:node.x,stroke:"black"})),node.children&&lines.push(react_1.default.createElement("line",{key:key++,x1:scaleX(node.data.height),x2:scaleX(node.data.height),y1:node.children[0].x,y2:node.children[node.children.length-1].x,stroke:"black"}))}),react_1.default.createElement("g",{transform:`translate(-${dimensions.marginLeft}, 0)`},lines)}}},[[233,1,2]]]);
//# sourceMappingURL=main.da22ded11727ef7f18c6.bundle.js.map