(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{178:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),react_default=__webpack_require__.n(react),d3=__webpack_require__(7),agnes=__webpack_require__(648),matrix=__webpack_require__(646),ResizeObserver_es=__webpack_require__(305);function combineChartDimensions(config,additionalMarginLeft,additionalMarginTop){let parsedDimensions={marginTop:5,marginRight:5,marginBottom:5,marginLeft:5,width:0,height:0,additionalMarginLeft:additionalMarginLeft,additionalMarginTop:additionalMarginTop,...config};return parsedDimensions.marginLeft+=additionalMarginLeft,parsedDimensions.marginTop+=additionalMarginTop,{...parsedDimensions,boundedHeight:Math.max((parsedDimensions.height||0)-parsedDimensions.marginTop-parsedDimensions.marginBottom,0),boundedWidth:Math.max((parsedDimensions.width||0)-parsedDimensions.marginLeft-parsedDimensions.marginRight,0)}}const ChartContext=Object(react.createContext)(null),useContextDimensions=()=>{const dimensions=Object(react.useContext)(ChartContext);if(null===dimensions)throw new Error("useContextDimensions must be used inside a Chart");return dimensions};var src_Chart=({dimensions:dimensions,children:children})=>react_default.a.createElement(ChartContext.Provider,{value:dimensions},react_default.a.createElement("svg",{style:{overflow:"visible"},width:dimensions.width,height:dimensions.height,xmlns:"http://www.w3.org/2000/svg"},react_default.a.createElement("g",{transform:`translate(${dimensions.marginLeft}, ${dimensions.marginTop})`},children)));var src_Map=Object(react.memo)((function Map(props){const{data:data,xAccessor:xAccessor,yAccessor:yAccessor,elementHeight:elementHeight,elementWidth:elementWidth,colorAccessor:colorAccessor}=props,squares=[];for(let i=0;i<data.length;i++)for(let j=0;j<data[i].length;j++)squares.push(react_default.a.createElement("rect",{key:`${i}-${j}`,x:xAccessor(j),y:yAccessor(i),width:elementWidth,height:elementHeight,fill:colorAccessor(data[i][j])}));return react_default.a.createElement("g",null,squares)}));function XAxis(props){const{labels:labels,xAccessor:xAccessor}=props,dimensions=useContextDimensions();return react_default.a.createElement("g",{transform:`translate(0, ${dimensions.boundedHeight})`},labels.map((label,i)=>{const x=xAccessor(i);return react_default.a.createElement(react.Fragment,{key:i},react_default.a.createElement("line",{x1:x,x2:x,y2:"10",stroke:"#bdc3c7"}),react_default.a.createElement("text",{transform:`translate(${x}, 15)rotate(-45)`,textAnchor:"end",fontSize:"0.8em",dominantBaseline:"hanging"},label))}))}function YAxis(props){const{labels:labels,yAccessor:yAccessor}=props,dimensions=useContextDimensions();return react_default.a.createElement("g",{transform:`translate(${dimensions.boundedWidth}, 0)`},labels.map((label,i)=>{const y=yAccessor(i);return react_default.a.createElement(react.Fragment,{key:i},react_default.a.createElement("line",{y1:y,y2:y,x2:"10",stroke:"#bdc3c7"}),react_default.a.createElement("text",{transform:`translate(15, ${y})`,textAnchor:"start",fontSize:"0.8em",dominantBaseline:"middle"},label))}))}function XDendrogram(props){const dimensions=useContextDimensions(),cluster=d3.a().size([dimensions.boundedWidth,props.height]).separation(()=>1)(props.hierarchy),scaleY=d3.f().domain([cluster.data.height,0]).range([0,props.height-5]),lines=[];let key=0;return cluster.eachAfter(node=>{node.parent&&lines.push(react_default.a.createElement("line",{key:key++,y1:scaleY(node.data.height),y2:scaleY(node.parent.data.height),x1:node.x,x2:node.x,stroke:"black"})),node.children&&lines.push(react_default.a.createElement("line",{key:key++,y1:scaleY(node.data.height),y2:scaleY(node.data.height),x1:node.children[0].x,x2:node.children[node.children.length-1].x,stroke:"black"}))}),react_default.a.createElement("g",{transform:`translate(0, -${props.height})`},lines)}function YDendrogram(props){const dimensions=useContextDimensions(),cluster=d3.a().size([dimensions.boundedHeight,props.width]).separation(()=>1)(props.hierarchy),scaleX=d3.f().domain([cluster.data.height,0]).range([0,props.width-5]),lines=[];let key=0;return cluster.eachAfter(node=>{node.parent&&lines.push(react_default.a.createElement("line",{key:key++,x1:scaleX(node.data.height),x2:scaleX(node.parent.data.height),y1:node.x,y2:node.x,stroke:"black"})),node.children&&lines.push(react_default.a.createElement("line",{key:key++,x1:scaleX(node.data.height),x2:scaleX(node.data.height),y1:node.children[0].x,y2:node.children[node.children.length-1].x,stroke:"black"}))}),react_default.a.createElement("g",{transform:`translate(-${props.width}, 0)`},lines)}function Legend(props){const dimensions=useContextDimensions(),gradient=function useLinearGradient(colorAccessor){const result=[];for(let i=0;i<=256;i++)result.push(),result.push({offset:`${i/256*100}%`,color:colorAccessor(i/256)});return react_default.a.createElement("linearGradient",{id:"legend-gradient"},result.map((color,i)=>react_default.a.createElement("stop",{key:i,offset:color.offset,stopColor:color.color})))}(props.colorAccessor),scale=d3.f().domain(props.domain).range([0,250]).nice(),ticks=scale.ticks(5);return react_default.a.createElement("g",{transform:`translate(-${dimensions.additionalMarginLeft}, -${dimensions.additionalMarginTop})`},react_default.a.createElement("defs",null,gradient),react_default.a.createElement("rect",{x:"0",y:"0",width:"250",height:"20",fill:"url(#legend-gradient)"}),ticks.map((tickValue,i)=>{const x=scale(tickValue);return react_default.a.createElement(react.Fragment,{key:i},react_default.a.createElement("line",{x1:x,x2:x,y1:"20",y2:"25",stroke:"black"}),react_default.a.createElement("text",{x:x,y:"28",dominantBaseline:"hanging",textAnchor:"middle",fontSize:"0.9em"},tickValue))}),react_default.a.createElement("text",{x:"0",y:"45",dominantBaseline:"hanging",textAnchor:"left"},props.title))}__webpack_require__.d(__webpack_exports__,"a",(function(){return src_Heatmap}));const src_Heatmap=Object(react.memo)((function Heatmap(props){const{xClustering:xClustering=!1,xClusteringHeight:xClusteringHeight=150,xClusteringMethod:xClusteringMethod="complete",yClustering:yClustering=!1,yClusteringWidth:yClusteringWidth=150,yClusteringMethod:yClusteringMethod="complete",colorScale:colorScale=d3.e,legend:legend=!1}=props;let additionalMarginTop=0;legend&&(additionalMarginTop+=80),xClustering&&(additionalMarginTop+=xClusteringHeight);let additionalMarginLeft=0;yClustering&&(additionalMarginLeft+=yClusteringWidth);const[ref,dimensions]=function useChartDimensions(dimensionsConfig={},additionalMarginLeft,additionalMarginTop){const ref=Object(react.useRef)(),dimensions=Object(react.useMemo)(()=>combineChartDimensions(dimensionsConfig,additionalMarginLeft,additionalMarginTop),[dimensionsConfig,additionalMarginLeft,additionalMarginTop]),[width,changeWidth]=Object(react.useState)(0),[height,changeHeight]=Object(react.useState)(0);Object(react.useEffect)(()=>{if(dimensions.width&&dimensions.height)return;const element=ref.current,resizeObserver=new ResizeObserver_es.a(entries=>{if(!Array.isArray(entries))return;if(!entries.length)return;const entry=entries[0];width!==entry.contentRect.width&&changeWidth(entry.contentRect.width),height!==entry.contentRect.height&&changeHeight(entry.contentRect.height)});return resizeObserver.observe(element),()=>resizeObserver.unobserve(element)},[dimensions,height,width]);const newSettings=combineChartDimensions({...dimensions,width:dimensions.width||width,height:dimensions.height||height},0,0);return[ref,newSettings]}(props.dimensions,additionalMarginLeft,additionalMarginTop),domain=function useDomain(data){return Object(react.useMemo)(()=>{let globalMin=1/0,globalMax=-1/0;for(const datum of data){const[min,max]=d3.b(datum);if(void 0===min||void 0===max)throw new Error("cannot work without min or max");min<globalMin&&(globalMin=min),max>globalMax&&(globalMax=max)}return[globalMin,globalMax]},[data])}(props.data),[xHierarchy,xLabels,dataAfterX]=function useXClustering(xClustering,xClusteringMethod,xLabels,data){return Object(react.useMemo)(()=>{if(!xClustering)return[null,xLabels,data];const transpose=new matrix.a(data).transpose().to2DArray(),cluster=Object(agnes.a)(transpose,{method:xClusteringMethod}),d3Hierarchy=d3.c(cluster),dataCopy=new matrix.a(data);let yLabelsCopy;xLabels&&(yLabelsCopy=xLabels.slice());const order=cluster.indices();for(let i=0;i<order.length;i++)order[i]!==i&&(dataCopy.setColumn(i,transpose[order[i]]),yLabelsCopy&&xLabels&&(yLabelsCopy[i]=xLabels[order[i]]));return[d3Hierarchy,yLabelsCopy,dataCopy.to2DArray()]},[xClustering,xClusteringMethod,xLabels,data])}(xClustering,xClusteringMethod,props.xLabels,props.data),[yHierarchy,yLabels,data]=function useYClustering(yClustering,yClusteringMethod,yLabels,data){return Object(react.useMemo)(()=>{if(!yClustering)return[null,yLabels,data];const cluster=Object(agnes.a)(data,{method:yClusteringMethod}),d3Hierarchy=d3.c(cluster),dataCopy=new matrix.a(data);let yLabelsCopy;yLabels&&(yLabelsCopy=yLabels.slice());const order=cluster.indices();for(let i=0;i<order.length;i++)order[i]!==i&&(dataCopy.setRow(i,data[order[i]]),yLabelsCopy&&yLabels&&(yLabelsCopy[i]=yLabels[order[i]]));return[d3Hierarchy,yLabelsCopy,dataCopy.to2DArray()]},[yClustering,yClusteringMethod,yLabels,data])}(yClustering,yClusteringMethod,props.yLabels,dataAfterX),xScale=d3.f().domain([0,data[0].length]).range([0,dimensions.boundedWidth]),yScale=d3.f().domain([0,data.length]).range([0,dimensions.boundedHeight]),colorAccessor=d3.g(colorScale).domain(domain),elementWidth=dimensions.boundedWidth-xScale(data[0].length-1),elementHeight=dimensions.boundedHeight-yScale(data.length-1);return react_default.a.createElement("div",{style:{height:"100%"},ref:ref},react_default.a.createElement(src_Chart,{dimensions:dimensions},xLabels&&react_default.a.createElement(XAxis,{labels:xLabels,xAccessor:i=>xScale(i)+elementWidth/2}),yLabels&&react_default.a.createElement(YAxis,{labels:yLabels,yAccessor:i=>yScale(i)+elementHeight/2}),legend&&react_default.a.createElement(Legend,{colorAccessor:colorScale,title:props.legendTitle||"",domain:domain}),react_default.a.createElement(src_Map,{data:data,xAccessor:xScale,yAccessor:yScale,elementWidth:elementWidth,elementHeight:elementHeight,colorAccessor:colorAccessor}),xHierarchy&&react_default.a.createElement(XDendrogram,{hierarchy:xHierarchy,height:xClusteringHeight}),yHierarchy&&react_default.a.createElement(YDendrogram,{hierarchy:yHierarchy,width:yClusteringWidth})))}))},337:function(module,exports,__webpack_require__){__webpack_require__(338),__webpack_require__(450),module.exports=__webpack_require__(451)},359:function(module,exports){},451:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(20),__webpack_require__(25),__webpack_require__(19),__webpack_require__(21),__webpack_require__(29);var _storybook_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(86),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(11);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_5__.addDecorator)(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.withKnobs);var req=__webpack_require__(639);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_5__.configure)((function loadStories(){req.keys().forEach((function(filename){return req(filename)}))}),module)}.call(this,__webpack_require__(247)(module))},639:function(module,exports,__webpack_require__){var map={"./index.stories.tsx":640};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=639},640:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),ml_matrix__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(646),d3__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7),ml_dataset_iris__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(177),_src_index__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(178);const irisNumbers=new ml_matrix__WEBPACK_IMPORTED_MODULE_3__.a(Object(ml_dataset_iris__WEBPACK_IMPORTED_MODULE_5__.getNumbers)()).center("column").scale("column"),irisData=irisNumbers.to2DArray(),classes=Object(ml_dataset_iris__WEBPACK_IMPORTED_MODULE_5__.getClasses)(),minValue=irisNumbers.min(),maxValue=irisNumbers.max(),convertScale=d3__WEBPACK_IMPORTED_MODULE_4__.f().range([minValue,maxValue]),colorScaleNeg=d3__WEBPACK_IMPORTED_MODULE_4__.g(d3__WEBPACK_IMPORTED_MODULE_4__.d).domain([minValue,-minValue]),colorScalePos=d3__WEBPACK_IMPORTED_MODULE_4__.g(d3__WEBPACK_IMPORTED_MODULE_4__.d).domain([-maxValue,maxValue]);function customColorScale(value){const converted=convertScale(value);return converted<0?colorScaleNeg(converted):colorScalePos(converted)}const clusteringMethods={"Single linkage":"single","Complete linkage":"complete","Unweighted average linkage (UPGMA)":"average","Weighted average linkage (WPGMA)":"wpgma","Centroid linkage (UPGMC)":"centroid",Ward:"ward","Ward 2":"ward2"};Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("Heatmap",module).add("Simple example",()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_index__WEBPACK_IMPORTED_MODULE_6__.a,{dimensions:{height:600},data:[[-20,-15,-10],[-5,0,5],[10,15,20]],xLabels:["Column 1","Column 2","Column 3"]})).add("Iris dataset with all options",()=>{const wantLegend=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("Show legend",!0),legendTitle=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.text)("Legend title","Iris values (normalized)"),wantXLabels=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("Show X labels",!0),wantYLabels=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("Show Y labels",!0);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{height:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Height",1800)}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_index__WEBPACK_IMPORTED_MODULE_6__.a,{dimensions:{marginLeft:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Left margin",5),marginTop:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Top margin",5),marginBottom:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Bottom margin",100),marginRight:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Right margin",150)},data:irisData,colorScale:customColorScale,legend:wantLegend,legendTitle:legendTitle,xClustering:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("X clustering",!0),xClusteringHeight:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("X clustering height",150),xClusteringMethod:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.select)("X clustering method",clusteringMethods,"complete"),yClustering:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("Y clustering",!0),yClusteringWidth:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.number)("Y clustering width",150),yClusteringMethod:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.select)("Y clustering method",clusteringMethods,"complete"),xLabels:wantXLabels?["sepal length","sepal width","petal length","petal width"]:void 0,yLabels:wantYLabels?classes:void 0}))})}.call(this,__webpack_require__(247)(module))}},[[337,1,2]]]);
//# sourceMappingURL=main.5df140a0b2bd604fd0fb.bundle.js.map